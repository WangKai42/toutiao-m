{"version":3,"sources":["webpack:///./src/views/search.vue?98f4","webpack:///./src/components/search-suggestion.vue?bbbe","webpack:///./src/api/search.js","webpack:///src/components/search-suggestion.vue","webpack:///./src/components/search-suggestion.vue?482e","webpack:///./src/components/search-suggestion.vue","webpack:///./src/components/search-history.vue?d339","webpack:///src/components/search-history.vue","webpack:///./src/components/search-history.vue?ccff","webpack:///./src/components/search-history.vue","webpack:///./src/components/search-result.vue?a33b","webpack:///src/components/search-result.vue","webpack:///./src/components/search-result.vue?6336","webpack:///./src/components/search-result.vue","webpack:///src/views/search.vue","webpack:///./src/views/search.vue?c77b","webpack:///./src/views/search.vue","webpack:///./src/components/search-result.vue?0a4e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","$event","onSearch","searchText","$router","back","isResultShow","model","value","callback","$$v","expression","searchHistorys","staticRenderFns","_l","str","index","key","$emit","domProps","_s","highlight","slot","getSearchSuggestion","q","request","method","url","params","getSearchResult","props","data","methods","replaceAll","components","watch","component","_v","isDeleteShow","item","onDelete","directives","name","rawName","finished","onLoad","loading","title","created","computed","SearchSuggestion","SearchHistory","SearchResult"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,OAAO,CAACG,MAAM,CAAC,OAAS,MAAM,CAACH,EAAG,aAAa,CAACG,MAAM,CAAC,cAAc,GAAG,YAAc,YAAYC,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOT,EAAIU,SAASV,EAAIW,aAAa,OAAS,SAASF,GAAQ,OAAOT,EAAIY,QAAQC,QAAQ,MAAQ,SAASJ,GAAQT,EAAIc,cAAe,IAAQC,MAAM,CAACC,MAAOhB,EAAc,WAAEiB,SAAS,SAAUC,GAAMlB,EAAIW,WAAWO,GAAKC,WAAW,iBAAiB,GAAInB,EAAgB,aAAEI,EAAG,gBAAgB,CAACG,MAAM,CAAC,cAAcP,EAAIW,cAAeX,EAAc,WAAEI,EAAG,oBAAoB,CAACG,MAAM,CAAC,cAAcP,EAAIW,YAAYH,GAAG,CAAC,OAASR,EAAIU,YAAYN,EAAG,iBAAiB,CAACG,MAAM,CAAC,kBAAkBP,EAAIoB,gBAAgBZ,GAAG,CAAC,OAASR,EAAIU,SAAS,iBAAiB,SAASD,GAAQT,EAAIoB,eAAiBX,OAAY,IAC11BY,EAAkB,G,wBCDlB,G,8BAAS,WAAa,IAAIrB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,qBAAqBN,EAAIsB,GAAItB,EAAe,aAAE,SAASuB,EAAIC,GAAO,OAAOpB,EAAG,WAAW,CAACqB,IAAID,EAAMjB,MAAM,CAAC,KAAO,UAAUC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOT,EAAI0B,MAAM,SAASH,MAAQ,CAACnB,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,SAASoB,SAAS,CAAC,UAAY3B,EAAI4B,GAAG5B,EAAI6B,UAAUN,KAAOO,KAAK,eAAc,KAClZ,EAAkB,G,YCMTC,EAAsB,SAAAC,GAC/B,OAAOC,eAAQ,CACXC,OAAQ,MACRC,IAAK,uBACLC,OAAQ,CACJJ,QAMCK,EAAkB,SAAAD,GAC3B,OAAOH,eAAQ,CACXC,OAAQ,MACRC,IAAK,mBACLC,Y,YCLR,GAEAE,MAAA,CACI3B,WAAJ,CACM,KAAN,OACM,UAAN,IAGA4B,KARA,WASA,OAEA,iBAGAC,QAAA,CACIX,UADJ,SACA,GAGM,OAAON,EAAIkB,WAAWxC,KAAKU,WAAjC,mCACA,gBADA,cAIA+B,WAAA,GAGAC,MAAA,CAEIhC,WAAJ,CACM,QAAN,oLACA,mBADA,gBACA,EADA,EACA,KACA,gCAFA,gDAGA,KAEM,WAAN,KClD2V,I,YCOvViC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,QClBX,EAAS,WAAa,IAAI5C,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,WAAW,CAACG,MAAM,CAAC,MAAQ,SAAS,CAAEP,EAAgB,aAAEI,EAAG,MAAM,CAACA,EAAG,OAAO,CAACI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOT,EAAI0B,MAAM,iBAAiB,OAAO,CAAC1B,EAAI6C,GAAG,UAAU7C,EAAI6C,GAAG,QAAQzC,EAAG,OAAO,CAACI,GAAG,CAAC,MAAQ,SAASC,GAAQT,EAAI8C,cAAe,KAAS,CAAC9C,EAAI6C,GAAG,UAAUzC,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,YAAYC,GAAG,CAAC,MAAQ,SAASC,GAAQT,EAAI8C,cAAe,OAAU,GAAG9C,EAAIsB,GAAItB,EAAkB,gBAAE,SAAS+C,EAAKvB,GAAO,OAAOpB,EAAG,WAAW,CAACqB,IAAID,EAAMjB,MAAM,CAAC,MAAQwC,GAAMvC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOT,EAAIgD,SAASD,EAAMvB,MAAU,CAACpB,EAAG,WAAW,CAAC6C,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASnC,MAAOhB,EAAgB,aAAEmB,WAAW,iBAAiBZ,MAAM,CAAC,KAAO,YAAY,OAAM,IAC9yB,EAAkB,GC0BtB,GAEA+B,MAAA,CACIlB,eAAJ,CACM,KAAN,MACM,UAAN,IAGAmB,KARA,WASA,OACA,kBAGAC,QAAA,CAEIQ,SAFJ,SAEA,KAEA,kBACQ,KAAR,2BAOM,KAAN,oBAGAN,WAAA,ICvDwV,ICOpV,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,I,QClBX,EAAS,WAAa,IAAI1C,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,WAAW,CAACG,MAAM,CAAC,SAAWP,EAAIoD,SAAS,gBAAgB,SAAS5C,GAAG,CAAC,KAAOR,EAAIqD,QAAQtC,MAAM,CAACC,MAAOhB,EAAW,QAAEiB,SAAS,SAAUC,GAAMlB,EAAIsD,QAAQpC,GAAKC,WAAW,YAAYnB,EAAIsB,GAAItB,EAAQ,MAAE,SAAS+C,EAAKvB,GAAO,OAAOpB,EAAG,WAAW,CAACqB,IAAID,EAAMjB,MAAM,CAAC,MAAQwC,EAAKQ,YAAW,IAAI,IACxa,EAAkB,G,YCetB,GAEAjB,MAAA,CACA,YACM,KAAN,OACM,UAAN,IAGAC,KARA,WASA,OACA,QACMe,SAAS,EACTF,UAAU,IAGhBZ,QAAA,CACA,OADA,WACA,oLAEA,GACA,YACA,oBACA,iBALA,gBAEA,EAFA,EAEA,KAMA,kBACA,0CAEA,aAGA,SACA,SAEA,cAjBA,+CAsBAE,WAAA,ICtDuV,ICQnV,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,gCCwBf,GAEAJ,MAAA,GAGAC,KALA,WAMA,OAEA,cAEA,gBAEA,2EAGAiB,QAfA,aAkBAhB,QAAA,CAEI9B,SAFJ,SAEA,GAEM,KAAN,aAEM,IAAN,kCACA,OAEQ,KAAR,2BAGM,KAAN,0BAKM,OAAN,OAAM,CAAN,uCAGM,KAAN,iBAEA,oBAtBA,WAsBA,8JAEA,yDAOA,mBATA,+CAYA+C,SAAA,kBACA,0BAEAd,MAAA,CAEIvB,eAFJ,WAGM,OAAN,OAAM,CAAN,yCAGAsB,WAAA,CACIgB,iBAAJ,EACIC,cAAJ,EACIC,aAAJ,IC3GgV,ICO5U,EAAY,eACd,EACA7D,EACAsB,GACA,EACA,KACA,WACA,MAIa,e,oEClBf","file":"js/chunk-2db13c5d.ad388b1c.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-container\"},[_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{attrs:{\"show-action\":\"\",\"placeholder\":\"请输入搜索关键词\"},on:{\"search\":function($event){return _vm.onSearch(_vm.searchText)},\"cancel\":function($event){return _vm.$router.back()},\"focus\":function($event){_vm.isResultShow = false}},model:{value:(_vm.searchText),callback:function ($$v) {_vm.searchText=$$v},expression:\"searchText\"}})],1),(_vm.isResultShow)?_c('search-result',{attrs:{\"search-text\":_vm.searchText}}):(_vm.searchText)?_c('search-suggestion',{attrs:{\"search-text\":_vm.searchText},on:{\"search\":_vm.onSearch}}):_c('search-history',{attrs:{\"search-historys\":_vm.searchHistorys},on:{\"search\":_vm.onSearch,\"updata-history\":function($event){_vm.searchHistorys = $event}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-suggestion\"},_vm._l((_vm.suggestions),function(str,index){return _c('van-cell',{key:index,attrs:{\"icon\":\"search\"},on:{\"click\":function($event){return _vm.$emit('search',str)}}},[_c('div',{attrs:{\"slot\":\"title\"},domProps:{\"innerHTML\":_vm._s(_vm.highlight(str))},slot:\"title\"})])}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/* \r\n搜索模块\r\n*/\r\n\r\nimport request from '../utils/request'\r\n\r\n// 获取联想建议\r\nexport const getSearchSuggestion = q => {\r\n    return request({\r\n        method: 'GET',\r\n        url: '/app/v1_0/suggestion',\r\n        params: {\r\n            q // 查询搜索关键词\r\n        }\r\n    })\r\n}\r\n\r\n// 获取搜索结果\r\nexport const getSearchResult = params => {\r\n    return request({\r\n        method: 'GET',\r\n        url: '/app/v1_0/search',\r\n        params\r\n    })\r\n}\r\n\r\n// 获取搜索历史\r\nexport const getSearchHistorys = () => {\r\n    return request({\r\n        method: 'GET',\r\n        url: '/app/v1_0/search/histories'\r\n    })\r\n}","<template>\r\n<div class=\"search-suggestion\">\r\n\r\n    <van-cell \r\n    icon=\"search\"\r\n    v-for=\"(str,index) in suggestions\"\r\n    :key=\"index\"\r\n    @click=\"$emit('search',str)\">\r\n    <!-- 高亮显示 -->\r\n    <div slot=\"title\" v-html=\"highlight(str)\"></div>\r\n    </van-cell>\r\n\r\n</div>\r\n</template>\r\n<script>\r\n import {getSearchSuggestion} from '../api/search'\r\n import { debounce } from 'lodash'\r\nexport default {\r\n\r\nprops:{\r\n    searchText:{\r\n        type:String,\r\n        required:true\r\n    }\r\n},\r\ndata(){\r\nreturn {\r\n    // 联想建议数据\r\n    suggestions:[]\r\n}\r\n},\r\nmethods:{\r\n    highlight(str){\r\n        // 正则表达式在的内容会被当做 字符串来处理\r\n        // new RegExp(this.searchText,'gi')\r\n      return str.replaceAll(this.searchText,\r\n        `<span style=\"color:red\"> ${this.searchText} </span`)\r\n    }\r\n},\r\ncomponents:{\r\n\r\n},\r\nwatch:{\r\n    // 要监视的数据的名称\r\n    searchText:{\r\n       handler: debounce( async function() {\r\n           const {data} = await getSearchSuggestion(this.searchText)\r\n           this.suggestions = data.data.options\r\n        },300),\r\n        // 初始化时就开始调用\r\n        immediate:true\r\n    }\r\n}\r\n};\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-suggestion.vue?vue&type=template&id=7f2550fc&scoped=true&\"\nimport script from \"./search-suggestion.vue?vue&type=script&lang=js&\"\nexport * from \"./search-suggestion.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7f2550fc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-history\"},[_c('van-cell',{attrs:{\"title\":\"历史记录\"}},[(_vm.isDeleteShow)?_c('div',[_c('span',{on:{\"click\":function($event){return _vm.$emit('updata-history',[])}}},[_vm._v(\"全部记录\")]),_vm._v(\"    \"),_c('span',{on:{\"click\":function($event){_vm.isDeleteShow = false}}},[_vm._v(\"完成\")])]):_c('van-icon',{attrs:{\"name\":\"delete-o\"},on:{\"click\":function($event){_vm.isDeleteShow = true}}})],1),_vm._l((_vm.searchHistorys),function(item,index){return _c('van-cell',{key:index,attrs:{\"title\":item},on:{\"click\":function($event){return _vm.onDelete(item, index)}}},[_c('van-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isDeleteShow),expression:\"isDeleteShow\"}],attrs:{\"name\":\"close\"}})],1)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"search-history\">\r\n    <van-cell title=\"历史记录\">\r\n        <div v-if=\"isDeleteShow\">\r\n            <span @click=\"$emit('updata-history',[])\">全部记录</span>\r\n            &nbsp;&nbsp;\r\n            <span @click=\"isDeleteShow = false\">完成</span>\r\n        </div>\r\n        <van-icon \r\n        name=\"delete-o\"\r\n        v-else\r\n        @click=\"isDeleteShow = true\" />\r\n    </van-cell>\r\n    <van-cell \r\n    :title=\"item\"\r\n    v-for=\"(item,index) in searchHistorys\"\r\n    :key=\"index\"\r\n    @click=\"onDelete(item, index)\">\r\n        <van-icon \r\n        name=\"close\" \r\n        v-show=\"isDeleteShow\"\r\n        />\r\n    </van-cell>\r\n</div>\r\n</template>\r\n<script>\r\n// import {setItem} from '../utils/storage'\r\nexport default {\r\n\r\nprops:{\r\n    searchHistorys:{\r\n        type:Array,\r\n        required:true\r\n    }\r\n},\r\ndata(){\r\nreturn {\r\n    isDeleteShow : false\r\n}\r\n},\r\nmethods:{\r\n    // 删除单个\r\n    onDelete(item,index) {\r\n        // 删除状态下点击删除\r\n        if(this.isDeleteShow) {\r\n            this.searchHistorys.splice(index,1)\r\n        //    持久化\r\n        //    setItem('search-historys',this.searchHistorys)\r\n           return\r\n \r\n        }\r\n        // 非删除状态下点击搜索\r\n        this.$emit('search',item)\r\n    }\r\n},\r\ncomponents:{\r\n\r\n},\r\n};\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-history.vue?vue&type=template&id=05a864f7&scoped=true&\"\nimport script from \"./search-history.vue?vue&type=script&lang=js&\"\nexport * from \"./search-history.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"05a864f7\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-result\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item,index){return _c('van-cell',{key:index,attrs:{\"title\":item.title}})}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"search-result\">\r\n    <van-list\r\n    v-model=\"loading\"\r\n    :finished=\"finished\"\r\n    finished-text=\"没有更多了\"\r\n    @load=\"onLoad\"\r\n    >\r\n    <van-cell v-for=\"(item,index) in list\" \r\n    :key=\"index\" \r\n    :title=\"item.title\" />\r\n    </van-list>\r\n</div>\r\n</template>\r\n<script>\r\nimport {getSearchResult} from '../api/search'\r\nexport default {\r\n\r\nprops:{\r\n  searchText:{\r\n        type:String,\r\n        required:true\r\n    }\r\n},\r\ndata(){\r\nreturn {\r\n    list: [],\r\n      loading: false,\r\n      finished: false,\r\n    }\r\n},\r\nmethods:{\r\n   async onLoad() {\r\n      // 1、请求获取数据\r\n    const {data} = await getSearchResult({\r\n      page:this.page,\r\n      per_page:this.per_page,\r\n      q:this.searchText\r\n    })\r\n      // 2、将数据放到·数据列表中\r\n      const {results} = data.data\r\n      this.list.push(...results)\r\n      // 3、关闭本次的 loading\r\n      this.loading = false\r\n      // 4、如果有则 更新获取下一页，如果没有\r\n        // 则把 finished 设置为 true 关闭加载更多\r\n      if(results.length) {\r\n        this.page++\r\n      }else {\r\n        this.finished = true\r\n      }\r\n        \r\n    },\r\n},\r\ncomponents:{\r\n\r\n},\r\n};\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n    .search-result {\r\n        position: fixed;\r\n        top: 54px;\r\n        bottom: 0;\r\n        left: 0;\r\n        right: 0;\r\n        overflow-y: auto;\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-result.vue?vue&type=template&id=83a966b2&scoped=true&\"\nimport script from \"./search-result.vue?vue&type=script&lang=js&\"\nexport * from \"./search-result.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search-result.vue?vue&type=style&index=0&id=83a966b2&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"83a966b2\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n<div class=\"search-container\">\r\n    <!-- 搜索框 -->\r\n    <!-- 在 van-search 外层增加 form 标签，\r\n    且 action 不为空，即可在 iOS 输入法中显示搜索按钮 -->\r\n    <form action=\"/\">\r\n        <van-search \r\n        v-model=\"searchText\" \r\n        show-action\r\n        placeholder=\"请输入搜索关键词\"\r\n        @search=\"onSearch(searchText)\"\r\n        @cancel=\"$router.back()\"\r\n        @focus=\"isResultShow = false\" />\r\n    </form>\r\n     <!-- 搜索框end -->\r\n\r\n    <!-- 搜索结果 -->\r\n    <search-result v-if=\"isResultShow\"\r\n    :search-text=\"searchText\" />\r\n    <!-- 搜索结果end -->\r\n\r\n    <!-- 联想建议 -->\r\n    <search-suggestion v-else-if=\"searchText\"\r\n    :search-text=\"searchText\"\r\n    @search=\"onSearch\" />\r\n    <!-- 联想建议end -->\r\n    <!-- 历史记录 -->\r\n    <search-history v-else \r\n    :search-historys=\"searchHistorys\"\r\n    @search=\"onSearch\"\r\n    @updata-history=\"searchHistorys = $event\"/>\r\n    <!-- 点击历史记录 开始搜索调用 @search=\"onSearch\" -->\r\n     <!-- 历史记录end -->\r\n\r\n</div> \r\n</template>\r\n<script>\r\nimport SearchSuggestion from '../components/search-suggestion.vue'\r\nimport SearchHistory from '../components/search-history.vue'\r\nimport SearchResult from '../components/search-result.vue'\r\nimport {setItem,getItem} from '../utils/storage'\r\n// import {getSearchHistorys} from '../api/search'\r\nimport {mapState} from 'vuex'\r\nexport default {\r\n\r\nprops:{\r\n\r\n},\r\ndata(){\r\nreturn {\r\n    // 搜索框绑定数据\r\n    searchText:'',\r\n    // 搜索结果组件的显示隐藏\r\n    isResultShow:false,\r\n    // 搜索历史数据\r\n    searchHistorys:getItem('search-historys',this.searchHistorys) || []\r\n}\r\n},\r\ncreated(){\r\n    // loadSearchHistories()\r\n},\r\nmethods:{\r\n    // 搜索\r\n    onSearch(searchText) {\r\n        // 把点击的搜索名 传给输入框\r\n        this.searchText = searchText\r\n        // 把搜索记录保存在this.searchText里\r\n        const index = this.searchHistorys.indexOf(searchText)\r\n        if (index !== -1) {\r\n            // 把触发项删除\r\n            this.searchHistorys.splice(index,1)\r\n        }\r\n        // 把最新数据存入数组\r\n        this.searchHistorys.unshift(searchText)\r\n\r\n        /* 如果用户已登录则把历史记录存储在线上 */\r\n\r\n        // 如果未登录则保存在本地\r\n        setItem('search-historys',this.searchHistorys)\r\n\r\n        // 显示搜索结果\r\n        this.isResultShow = true\r\n    },\r\n   async loadSearchHistories () {\r\n    //    把线上的记录和本地的合并起来\r\n    let searchHistorys = getItem('search-historys',this.searchHistorys) || []\r\n   /*  if (this.user) {\r\n        const {data} = await getSearchHistorys()\r\n        // console.log(data.data.keywords);\r\n        searchHistorys = [...new Set([...searchHistorys, ...data.data.keywords])]\r\n    } */\r\n        // console.log(searchHistorys);\r\n        this.searchHistorys = searchHistorys\r\n   }\r\n},\r\ncomputed:{\r\n    ...mapState(['user'])\r\n},\r\nwatch: {\r\n    // 监视搜索历史记录的变化，存储到本地，其余地方可省略\r\n    searchHistorys() {\r\n        setItem('search-historys',this.searchHistorys)\r\n    }\r\n},\r\ncomponents:{\r\n    SearchSuggestion,\r\n    SearchHistory,\r\n    SearchResult\r\n},\r\n};\r\n</script>\r\n\r\n<style scoped lang='less'>\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search.vue?vue&type=template&id=5b9f9b17&scoped=true&\"\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b9f9b17\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search-result.vue?vue&type=style&index=0&id=83a966b2&scoped=true&lang=less&\""],"sourceRoot":""}