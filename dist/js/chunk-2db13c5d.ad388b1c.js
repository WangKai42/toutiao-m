(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2db13c5d"],{"4e22":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-container"},[s("form",{attrs:{action:"/"}},[s("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:function(t){return e.onSearch(e.searchText)},cancel:function(t){return e.$router.back()},focus:function(t){e.isResultShow=!1}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),e.isResultShow?s("search-result",{attrs:{"search-text":e.searchText}}):e.searchText?s("search-suggestion",{attrs:{"search-text":e.searchText},on:{search:e.onSearch}}):s("search-history",{attrs:{"search-historys":e.searchHistorys},on:{search:e.onSearch,"updata-history":function(t){e.searchHistorys=t}}})],1)},n=[],a=s("5530"),c=s("1da1"),i=(s("96cf"),s("c975"),s("a434"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-suggestion"},e._l(e.suggestions,(function(t,r){return s("van-cell",{key:r,attrs:{icon:"search"},on:{click:function(s){return e.$emit("search",t)}}},[s("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.highlight(t))},slot:"title"})])})),1)}),o=[],h=s("b775"),u=function(e){return Object(h["a"])({method:"GET",url:"/app/v1_0/suggestion",params:{q:e}})},l=function(e){return Object(h["a"])({method:"GET",url:"/app/v1_0/search",params:e})},d=s("2ef0"),p={props:{searchText:{type:String,required:!0}},data:function(){return{suggestions:[]}},methods:{highlight:function(e){return e.replaceAll(this.searchText,'<span style="color:red"> '.concat(this.searchText," </span"))}},components:{},watch:{searchText:{handler:Object(d["debounce"])(Object(c["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u(this.searchText);case 2:t=e.sent,s=t.data,this.suggestions=s.data.options;case 5:case"end":return e.stop()}}),e,this)}))),300),immediate:!0}}},f=p,m=s("2877"),v=Object(m["a"])(f,i,o,!1,null,"7f2550fc",null),g=v.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-history"},[s("van-cell",{attrs:{title:"历史记录"}},[e.isDeleteShow?s("div",[s("span",{on:{click:function(t){return e.$emit("updata-history",[])}}},[e._v("全部记录")]),e._v("    "),s("span",{on:{click:function(t){e.isDeleteShow=!1}}},[e._v("完成")])]):s("van-icon",{attrs:{name:"delete-o"},on:{click:function(t){e.isDeleteShow=!0}}})],1),e._l(e.searchHistorys,(function(t,r){return s("van-cell",{key:r,attrs:{title:t},on:{click:function(s){return e.onDelete(t,r)}}},[s("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDeleteShow,expression:"isDeleteShow"}],attrs:{name:"close"}})],1)}))],2)},w=[],x={props:{searchHistorys:{type:Array,required:!0}},data:function(){return{isDeleteShow:!1}},methods:{onDelete:function(e,t){this.isDeleteShow?this.searchHistorys.splice(t,1):this.$emit("search",e)}},components:{}},b=x,S=Object(m["a"])(b,y,w,!1,null,"05a864f7",null),T=S.exports,_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-result"},[s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return s("van-cell",{key:t,attrs:{title:e.title}})})),1)],1)},H=[],O=s("2909"),j={props:{searchText:{type:String,required:!0}},data:function(){return{list:[],loading:!1,finished:!1}},methods:{onLoad:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s,r,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l({page:e.page,per_page:e.per_page,q:e.searchText});case 2:r=t.sent,n=r.data,a=n.data.results,(s=e.list).push.apply(s,Object(O["a"])(a)),e.loading=!1,a.length?e.page++:e.finished=!0;case 8:case"end":return t.stop()}}),t)})))()}},components:{}},k=j,R=(s("e553"),Object(m["a"])(k,_,H,!1,null,"83a966b2",null)),D=R.exports,$=s("5d2d"),E=s("2f62"),q={props:{},data:function(){return{searchText:"",isResultShow:!1,searchHistorys:Object($["a"])("search-historys",this.searchHistorys)||[]}},created:function(){},methods:{onSearch:function(e){this.searchText=e;var t=this.searchHistorys.indexOf(e);-1!==t&&this.searchHistorys.splice(t,1),this.searchHistorys.unshift(e),Object($["b"])("search-historys",this.searchHistorys),this.isResultShow=!0},loadSearchHistories:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=Object($["a"])("search-historys",e.searchHistorys)||[],e.searchHistorys=s;case 2:case"end":return t.stop()}}),t)})))()}},computed:Object(a["a"])({},Object(E["b"])(["user"])),watch:{searchHistorys:function(){Object($["b"])("search-historys",this.searchHistorys)}},components:{SearchSuggestion:g,SearchHistory:T,SearchResult:D}},C=q,L=Object(m["a"])(C,r,n,!1,null,"5b9f9b17",null);t["default"]=L.exports},"5ead":function(e,t,s){},e553:function(e,t,s){"use strict";s("5ead")}}]);
//# sourceMappingURL=chunk-2db13c5d.ad388b1c.js.map